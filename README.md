
# Sentiment Analysis API (Spring Boot + Kubernetes)

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –Ω–∞ Java (Spring Boot) –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞. –ü—Ä–æ–µ–∫—Ç —É–ø–∞–∫–æ–≤–∞–Ω –≤ Docker-–æ–±—Ä–∞–∑ (<150MB) –∏ —Å–∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤ Kubernetes —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤—ã—Å–æ–∫–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ (Replicas), –∞–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è (HPA) –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Prometheus + Grafana).

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
* **Java 17** + **Spring Boot 3.x** (Web, Actuator)
* **Docker** (Multi-stage build –Ω–∞ –±–∞–∑–µ Alpine)
* **Kubernetes** (Minikube)
* **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: Prometheus, Grafana, Micrometer

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
.
‚îú‚îÄ‚îÄ src/                    # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ Java
‚îÇ   ‚îî‚îÄ‚îÄ main/resources/
‚îÇ       ‚îî‚îÄ‚îÄ application.properties
‚îú‚îÄ‚îÄ k8s/                    # –ú–∞–Ω–∏—Ñ–µ—Å—Ç—ã Kubernetes
‚îÇ   ‚îî‚îÄ‚îÄ k8s-deployment.yaml # Deployment, Service, Ingress, HPA
‚îú‚îÄ‚îÄ Dockerfile              # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–±–æ—Ä–∫–∏
‚îú‚îÄ‚îÄ pom.xml                 # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Maven
‚îî‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
````

-----

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É (Minikube)

### 1\. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Docker –∏ Minikube. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä –∏ –≤–∫–ª—é—á–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∞–¥–¥–æ–Ω—ã:

```bash
# –ó–∞–ø—É—Å–∫ Minikube (4 —è–¥—Ä–∞, 8–ì–± RAM –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)
minikube start --cpus=4 --memory=8192mb --nodes=2

# –í–∫–ª—é—á–µ–Ω–∏–µ Metrics Server (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è HPA)
minikube addons enable metrics-server

# –í–∫–ª—é—á–µ–Ω–∏–µ Ingress (–¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏)
minikube addons enable ingress
```

### 2\. –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞

–ú—ã –Ω–µ –±—É–¥–µ–º –∑–∞–≥—Ä—É–∂–∞—Ç—å –æ–±—Ä–∞–∑ –≤ Docker Hub, –∞ —Å–æ–±–µ—Ä–µ–º –µ–≥–æ —Å—Ä–∞–∑—É –≤–Ω—É—Ç—Ä–∏ Minikube. –≠—Ç–æ –±—ã—Å—Ç—Ä–µ–µ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ.

```bash
# 1. –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Docker-–¥–µ–º–æ–Ω–∞ –≤–Ω—É—Ç—Ä–∏ Minikube
eval $(minikube docker-env)

# 2. –°–æ–±–∏—Ä–∞–µ–º –æ–±—Ä–∞–∑ (–æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Ç–æ—á–∫—É –≤ –∫–æ–Ω—Ü–µ)
docker build -t sentiment-app:latest .
```

*–¢–µ–ø–µ—Ä—å –æ–±—Ä–∞–∑ `sentiment-app:latest` –¥–æ—Å—Ç—É–ø–µ–Ω –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞.*

### 3\. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü—Ä–∏–º–µ–Ω—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–ø–∫–∏ `k8s`:

```bash
kubectl apply -f k8s/
```

*–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç Deployment (3 —Ä–µ–ø–ª–∏–∫–∏), Service, Ingress –∏ HPA.*

### 4\. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (Prometheus + Grafana)

–£—Å—Ç–∞–Ω–æ–≤–∏–º —Å—Ç–µ–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —á–µ—Ä–µ–∑ Helm:

```bash
# –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
helm repo add prometheus-community [https://prometheus-community.github.io/helm-charts](https://prometheus-community.github.io/helm-charts)
helm repo update

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Prometheus –∏ Grafana
helm install prometheus prometheus-community/kube-prometheus-stack
```

-----

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

–¢–∞–∫ –∫–∞–∫ Service –∏–º–µ–µ—Ç —Ç–∏–ø `LoadBalancer`, –≤ Minikube –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –∫–æ–º–∞–Ω–¥—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è URL:

```bash
minikube service sentiment-service --url
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∞–¥—Ä–µ—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, `http://192.168.49.2:32000`) –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –∑–∞–ø—Ä–æ—Å:

```bash
curl "http://IP_ADDRESS:PORT/api/sentiment?text=Hello%20World"
# –û—Ç–≤–µ—Ç: {"sentiment":"positive","input":"Hello World"}

curl "http://IP_ADDRESS:PORT/api/sentiment?text=This%20is%20bad"
# –û—Ç–≤–µ—Ç: {"sentiment":"negative","input":"This is bad"}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫

–ú–µ—Ç—Ä–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ –ø—É—Ç–∏: `/actuator/prometheus`.

### –î–æ—Å—Ç—É–ø –∫ Grafana

–ß—Ç–æ–±—ã –∑–∞–π—Ç–∏ –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å Grafana:

1.  **–ü—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–∞:**
    ```bash
    kubectl port-forward svc/prometheus-grafana 3000:80
    ```
2.  –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: `http://localhost:3000`
3.  **–õ–æ–≥–∏–Ω/–ü–∞—Ä–æ–ª—å:** `admin` / `prom-operator` (–ø–∞—Ä–æ–ª—å –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã Kubernetes, –µ—Å–ª–∏ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç).
4.  **–î–∞—à–±–æ—Ä–¥:** –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞—à–±–æ—Ä–¥ —Å **ID 4701** (JVM Micrometer) –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç—Ä–∏–∫ Spring Boot.

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è (HPA)

–ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫ Kubernetes —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–µ –ø–æ–¥—ã –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π:

1.  –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
    ```bash
    kubectl run -i --tty load-generator --rm --image=busybox --restart=Never -- /bin/sh -c "while sleep 0.01; do wget -q -O- http://sentiment-service/api/sentiment?text=test; done"
    ```
2.  –ù–∞–±–ª—é–¥–∞–π—Ç–µ –∑–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º:
    ```bash
    kubectl get hpa -w
    ```
    *–ß–µ—Ä–µ–∑ 1-2 –º–∏–Ω—É—Ç—ã –Ω–∞–≥—Ä—É–∑–∫–∞ (TARGETS) –≤—ã—Ä–∞—Å—Ç–µ—Ç, –∏ REPLICAS —É–≤–µ–ª–∏—á–∏—Ç—Å—è —Å 3 –¥–æ –º–∞–∫—Å. 10.*

-----

## üìù API Endpoints

| –ú–µ—Ç–æ–¥ | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| `GET` | `/api/sentiment?text=...` | –ê–Ω–∞–ª–∏–∑ —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç–µ–∫—Å—Ç–∞ |
| `GET` | `/actuator/health` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–µ—Ä–≤–∏—Å–∞ (Liveness probe) |
| `GET` | `/actuator/prometheus` | –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è Prometheus |

```
```